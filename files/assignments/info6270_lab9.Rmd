---
title: "INFO6270 Lab 9"
author: "Philippe Mongeon" # Replace my name with yours
date: "2022-03-10" # Put the date here
output: 
  html_document:
    toc: true 
    toc_float:       
      collapsed: false
    toc_depth: 2
    number_sections: true 
    theme: default
---

# Introduction

In this lab you will build a logistic regression model that predicts a categorical variable based on other variables in your dataset.

# Setup

## Load libraries

```{r message=FALSE, warning=FALSE}
library(tidyverse) # for all the tidyverse goodies
library(kableExtra) # If you feel like printing pretty tables
```

## Data preparation

#### Choose a dataset

For this lab, you can use a dataset of your choice. The criteria are:

-   The dataset must contain a dichotomous categorical variable that you will use as the dependent variable.

-   The dataset must contain at least two other variables (of any type) that will be used as predictors.

#### Load your dataset

Make sure to use the name "data" for your dataset, so that some codes below will work without requiring changes.

```{r message=FALSE, warning=FALSE}
data <- Insert code to read data here
```

#### Tidy your dataset

perform whatever steps are necessary to convert your dataset in a tidy format, if it is not already in a tidy format.

```{r}

```

#### Choose variables for the model

You want to update your tibble so that it contains only the variables of interest (including the dependent variable of course).

```{r}

```

#### Set you categorical variables as factors

Here you want to use the mutate() and as_factor() functions to modify your categorical variables and make them factors.

```{r}

```

#### Identify missing data

```{r}

```

#### Deal with missing data

You have to choices 1) do nothing and drop the incomplete observations from your model, or use some rule to assign an estimated value to the missing ones (e.g. using the average for numeric variables).

```{r}

```

## Logistic regression model

#### Create the model

```{r}
model <- glm(your code here)
```

#### Print the summary of the model

```{r}
summary(model)
```

#### Create a tibble with the odds ratio and the confidence intervals

Use level = .95 for your confidence intervals.

```{r}
odds_ratio <- cbind(Odds_Ratio = exp(model$coefficients), exp(confint(model, level = .95)))
```

#### Add a probability column to your dataset 

```{r}
data <- tibble(data,
               Probability = model$fitted.values)
```

#### Add a prediction column to your dataset

```{r}
data <- data %>% 
  mutate(Prediction = if_else(Probability > 0.5,1,0))
```

#### Create a table that compares the predictions of your model to the real data

```{r}
table(Survived = data$NAME_OF_YOUR_DEPENDENT_VARIABLE, Predicted = data$Prediction)
```

#### Calculate the success rate of your model

```{r}
mean(data$NAME_OF_YOUR_DEPENDENT_VARIABLE == data$Prediction)
```

#### Answer the following questions

1.  How successful was your model at predicting the data (success rate)?
2.  What variables are the strongest predictor of your dependent variable?
3.  What is the direction (positive or negative) of the relationship between those strong predictors and the dependent variable?
4.  Are all predictors statistically significant (P \< 0.05)?

